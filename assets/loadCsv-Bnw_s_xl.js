import{P as g}from"./papaparse.min-3Cp_gg1b.js";import"./index-HagMOEIN.js";const h=["/docs/PremiumExtract Strategy.csv","/docs/PremiumExtract%20Strategy.csv"];function w(o){for(let n=0;n<o.length;n++){const e=o[n].map(t=>(t||"").toString().trim().toLowerCase());if(e.includes("date placed")||e.includes("date placed".toLowerCase())||e.includes("date")||e.includes("ticker")&&e.includes("p&l"))return n}return-1}function f(o,n){const e={};for(const a in n)e[a]=o[n[a]]!==void 0?o[n[a]]:"";const t={date:e["Exit Date"]||e["exit date"]||e.date||e.Date||"",dateOpened:e["Date placed"]||e["date placed"]||"",symbol:e.Ticker||e.ticker||"",quantity:e.contracts?Number(e.contracts):void 0,pnl:e["P&L"]!==void 0?Number(e["P&L"]):e.PnL!==void 0?Number(e.PnL):void 0,maxRisk:e["Max risk"]?Number(e["Max risk"]):e["Max Risk"]?Number(e["Max Risk"]):void 0,strategy:e["strategy type"]||e.Strategy||e.strategy||"",raw:e},r=[];if((t.pnl===void 0||Number.isNaN(t.pnl))&&r.push("Missing PnL"),(t.maxRisk===void 0||t.maxRisk===0||Number.isNaN(t.maxRisk))&&r.push("Missing Max risk"),r.length===0?t.roi=t.pnl/t.maxRisk*100:t.roi=void 0,t.issues=r,t.date){const a=new Date(t.date);if(!Number.isNaN(a.getTime())){const u=a.getFullYear(),c=String(a.getMonth()+1).padStart(2,"0"),d=String(a.getDate()).padStart(2,"0");t.date=`${u}-${c}-${d}`}}if(t.dateOpened){const a=new Date(t.dateOpened);if(!Number.isNaN(a.getTime())){const u=a.getFullYear(),c=String(a.getMonth()+1).padStart(2,"0"),d=String(a.getDate()).padStart(2,"0");t.dateOpened=`${u}-${c}-${d}`}}return t}async function k(){for(const o of h)try{const n=await fetch(o);if(!n.ok)continue;const e=await n.text(),r=g.parse(e,{skipEmptyLines:!0,dynamicTyping:!1}).data;if(!r||!r.length)throw new Error("Empty CSV");const a=w(r);if(a===-1){if(r.length<2)throw new Error("No header row found");const m=r[0].map(i=>(i||"").toString().trim()),p={};return m.forEach((i,l)=>p[i]=l),r.slice(1).map(i=>f(i,p)).filter(i=>i.symbol||i.date)}const c=r[a].map(s=>(s||"").toString().trim()),d={};return c.forEach((s,m)=>d[s]=m),r.slice(a+1).map(s=>f(s,d)).filter(s=>s.symbol||s.date)}catch{}throw new Error("No local CSV found in /docs")}export{k as loadLocalCsv};
